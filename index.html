<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interaktive Kategorisierungs체bung</title>
    <style>
        /* Dein bestehendes CSS bleibt unver채ndert */
    </style>
</head>
<body>
    <div class="container">
        <h1>Kategorisierungs체bung</h1>
        <p>Ordne die folgenden Aussagen den richtigen Kategorien zu. Ziehe sie in die entsprechenden Felder.</p>
        <div class="categories">
            <div class="category" id="category1" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h3>24 Monate Laufzeit</h3>
            </div>
            <div class="category" id="category2" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h3>12 Monate Laufzeit</h3>
            </div>
            <div class="category" id="category3" ondrop="drop(event)" ondragover="allowDrop(event)">
                <h3>1 Monat Laufzeit</h3>
            </div>
        </div>
        <div id="statements"></div>
        <div id="score">Punktzahl: <span id="points">0</span> / 9</div>
        <div class="button-container">
            <button id="backButton" class="button" disabled>Zur체ck</button>
            <button id="nextButton" class="button" disabled onclick="window.location.href='https://hikimetti.github.io/TK/tyfys.html'">Weiter</button>
        </div>
    </div>

    <div id="myModal" class="modal">
        <div class="modal-content">
            <p>Gratulation! Du hast alle Aussagen richtig zugeordnet!</p>
            <button class="ok-button" onclick="closeModal()">Ok</button>
        </div>
    </div>

    <script>
        const statements = [
            { text: "MagentaZuhause XL mit MagentaTV Smart", correctCategory: "category1" },
            { text: "MEGA SPORT", correctCategory: "category2" },
            { text: "CountryFlat 1.5", correctCategory: "category3" },
            { text: "WLAN Comfort", correctCategory: "category2" },
            { text: "GIGA 1000", correctCategory: "category1" },
            { text: "TV-Paket Family", correctCategory: "category3" },
            { text: "MagentaMobil Basic", correctCategory: "category1" },
            { text: "MagentaSport", correctCategory: "category3" },
            { text: "Speedport Smart", correctCategory: "category2" },
        ];

        let score = 0;
        let draggedElement = null;

        function createStatements() {
            const statementsContainer = document.getElementById("statements");
            statements.forEach((statement, index) => {
                const div = document.createElement("div");
                div.className = "statement";
                div.draggable = true;
                div.id = `statement${index}`;
                div.ondragstart = drag;
                
                // Mobile Touch Support
                div.addEventListener('touchstart', touchStart);
                div.addEventListener('touchend', touchEnd);
                div.addEventListener('touchmove', touchMove);
                
                const span = document.createElement("span");
                span.textContent = statement.text;
                div.appendChild(span);
                
                statementsContainer.appendChild(div);
            });
        }

        function allowDrop(ev) {
            ev.preventDefault();
        }

        function drag(ev) {
            ev.dataTransfer.setData("text", ev.target.id);
        }

        function drop(ev) {
            ev.preventDefault();
            const data = ev.dataTransfer.getData("text");
            const draggedElement = document.getElementById(data);
            
            let targetElement = ev.target;

            while (!targetElement.classList.contains('category')) {
                targetElement = targetElement.parentElement;
            }
            
            targetElement.appendChild(draggedElement);
            checkAnswer(parseInt(draggedElement.id.replace("statement", "")), targetElement.id);
        }

        function touchStart(ev) {
            draggedElement = ev.target.closest('.statement');
            if (draggedElement) {
                draggedElement.style.opacity = '0.4';
            }
        }

        function touchMove(ev) {
            ev.preventDefault();
            if (!draggedElement) return;
            const touch = ev.targetTouches[0];
            draggedElement.style.position = 'absolute';
            draggedElement.style.left = touch.pageX - (draggedElement.offsetWidth / 2) + 'px';
            draggedElement.style.top = touch.pageY - (draggedElement.offsetHeight / 2) + 'px';
        }

        function touchEnd(ev) {
            ev.preventDefault();
            if (!draggedElement) return;
            draggedElement.style.opacity = '1';

            let targetElement = document.elementFromPoint(ev.changedTouches[0].clientX, ev.changedTouches[0].clientY);

            while (targetElement && !targetElement.classList.contains('category')) {
                targetElement = targetElement.parentElement;
            }
            
            if (targetElement && draggedElement) {
                targetElement.appendChild(draggedElement);
                draggedElement.style.position = 'initial';
                draggedElement.style.left = 'initial';
                draggedElement.style.top = 'initial';
                checkAnswer(parseInt(draggedElement.id.replace("statement", "")), targetElement.id);
                draggedElement = null; // Reset dragged element
            }
        }

        function checkAnswer(statementIndex, categoryId) {
            const statement = statements[statementIndex];
            const element = document.getElementById(`statement${statementIndex}`);
            if (statement.correctCategory === categoryId) {
                element.classList.add("correct");
                score++;
            } else {
                element.classList.add("incorrect");
                score--;
            }
            document.getElementById("points").textContent = `${score} / ${statements.length}`;
            if (score === statements.length) {
                document.getElementById("nextButton").disabled = false;
                document.getElementById("myModal").style.display = "flex";
            }
        }

        function closeModal() {
            document.getElementById("myModal").style.display = "none";
        }

        createStatements();
    </script>
</body>
</html>
